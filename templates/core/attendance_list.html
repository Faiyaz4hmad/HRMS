{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-between align-center mb-3">
    <h1>Attendance Log</h1>
    <a href="{% url 'attendance_mark' %}" class="btn btn-primary">Mark New Attendance</a>
</div>

<div class="card mb-3">
    <form method="get" class="d-flex align-center" style="gap: 1rem;">
        <label for="date_filter" style="margin: 0;">Filter by Date:</label>
        <input type="date" id="date_filter" name="date" class="form-control" style="width: auto;"
            value="{{ request.GET.date }}">
        <button type="submit" class="btn btn-secondary">Filter</button>
        {% if request.GET.date %}
        <a href="{% url 'attendance_list' %}" class="btn" style="color: var(--accent-color);">Clear</a>
        {% endif %}
    </form>
</div>

<div class="card">
    {% if records %}
    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Employee Name</th>
                    <th>ID</th>
                    <th>Department</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>{{ record.date|date:"M d, Y" }}</td>
                    <td>{{ record.employee.full_name }}</td>
                    <td>{{ record.employee.employee_id }}</td>
                    <td>{{ record.employee.get_department_display }}</td>
                    <td>
                        <span
                            class="badge {% if record.status == 'Present' %}badge-success{% else %}badge-danger{% endif %}">
                            {{ record.status }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="text-center" style="color: #666; margin: 2rem 0;">No attendance records found.</p>
    {% endif %}
</div>
{% endblock %}